<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous"></script>
    <!-- Google Charts ë¡œë”© -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- JavaScript ë¡œì§ ì¶”ê°€ (HTML íŒŒì¼ í•˜ë‹¨ì— ì‚½ì…) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  async function loadAnalysis(type) {
    let endpoint = '';
    let title = '';
    let chartType = '';

    switch(type) {
      case 'threshold':
        endpoint = '/profiles/threshold';
        title = 'ë¹„ì •ìƒì ì¸ ë†’ì€ ìì› ì‚¬ìš©ëŸ‰ (2000 ì´ìƒ)';
        chartType = 'bar';
        break;
      case 'zscore':
        endpoint = '/profiles/zscore';
        title = 'Z-score ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€';
        chartType = 'polarArea';
        break;
      case 'variance':
        endpoint = '/profiles/variance';
        title = 'ë¶„ì‚° ê¸°ë°˜ ë¶€í•˜ ë¶ˆê· í˜• ê°ì§€';
        chartType = 'radar';
        break;
      case 'concentration':
        endpoint = '/profiles/concentration';
        title = 'íŠ¹ì • ì½”ì–´ ìì› ì§‘ì¤‘ë„ ë¶„ì„';
        chartType = 'doughnut';
        break;
    }

    const response = await fetch(endpoint);
    const result = await response.json();
    const area = document.getElementById('validation-result-area');
    area.innerHTML = '<canvas id="dynamicChart"></canvas>';
    document.querySelector('h3.mb-3').innerText = title;

    const labels = result.map(row => row.label);
    const values = result.map(row => parseFloat(row.value));

    const ctx = document.getElementById('dynamicChart').getContext('2d');
    new Chart(ctx, {
      type: chartType,
      data: {
        labels: labels,
        datasets: [{
          label: title,
          data: values,
          backgroundColor: [
            '#E74C3C','#F1C40F','#3498DB','#2ECC71','#9B59B6','#1ABC9C','#E67E22','#34495E'
          ],
          borderColor: '#fff',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' },
          title: { display: true, text: title }
        },
        animation: {
          duration: 1500,
          easing: 'easeOutBounce'
        }
      }
    });
  }
</script>


</head>

<body>
  <div class="container">
    <nav class="navbar navbar-expand-lg fixed-top bg-primary">
      <div class="container">
        <div class="navbar-brand text-white">
          <h1 class="mx-auto">
            <a href="/index2" style="color:yellow;text-decoration:none">[í–¥ìƒëœ Profiler2]</a>
          </h1>
        </div>
        <div class="text-white align-right">
          <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#staticBackdrop"
            id="modal">
            ì‚¬ìš©ì„¤ëª…ì„œ
          </button>
        </div>
      </div>
    </nav>

    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
      aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">ë°˜ê°‘ìŠµë‹ˆë‹¤!</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
           <div class="btn-info">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50">
            <img src="https://cdn.pixabay.com/photo/2016/05/28/18/29/exclamation-point-1421914_1280.png" width="50" height="50"><br>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
              <ol class="text-start">
                <li>íŒŒì¼ì„ ì„ íƒí•©ë‹ˆë‹¤.</li>
                <li>ì œì¶œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</li>
                <li>íŒŒì¼ ë°ì´í„°ë¥¼ ì½ì–´ì„œ ìœ íš¨ì„± ê²€ì¦ì„ í•©ë‹ˆë‹¤. <br>
                  (ì´ìƒì¹˜, ê²°ì¸¡ì¹˜, ì •ìˆ˜ì´ì™¸ì˜ ë°ì´í„° ë“±ì˜ í¬í•¨ì—¬ë¶€)
                </li>
                <li>ê²€ì¦ì´ ì™„ë£Œë˜ë©´ DBì— ì €ì¥í•©ë‹ˆë‹¤.</li>
                <li>DBì—ì„œ ê°€ì§€ê³  ì˜¨ ë°ì´í„°ë¡œ í†µê³„ì™€ ì°¨íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
              </ol>
            </button>

           </div>
            <div><b style="color:red;">ë§Œì•½ ë°ì´í„°ê°€ ëˆ„ë½ë˜ì—ˆë‹¤ë©´, ëˆ„ë½ëœ ë°ì´í„°ë¥¼ ì œì™¸í•œ í”„ë¡œíŒŒì¼ë§ ê²°ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</b></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
          </div>
        </div>
      </div>
    </div>

    <div class="container" style="margin:100px auto 20px auto;"></div>
    <form id="profile_form2" class="mt-4">
      <div class="mb-3">
        <label for="input_profile" class="form-label fw-bold">ğŸ“ ì—…ë¡œë“œí•  íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</label>
        <div class="input-group">
          <input type="file" class="form-control" id="input_profile" name="input_profile" multiple>
          <button class="btn btn-outline-primary" type="submit" id="inputGroupFileAddon04">ì œì¶œ</button>
        </div>
      </div>
    </form>
  </div>
  <hr color="red" size="10">
  <div class="container mt-5">
    <!-- HTML: menus ë²„íŠ¼ ì¶”ê°€ -->
<div class="d-flex flex-wrap gap-4 justify-content-center" id="menus">
  <button class="btn btn-outline-danger" onclick="loadAnalysis('threshold')">
    ğŸ“ˆ ë¹„ì •ìƒì ì¸ ë†’ì€ ìì› ì‚¬ìš©ëŸ‰ (2000 ì´ìƒ)
  </button>
  <button class="btn btn-outline-warning" onclick="loadAnalysis('zscore')">
    ğŸ“Š Z-score ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€
  </button>
  <button class="btn btn-outline-info" onclick="loadAnalysis('variance')">
    ğŸ“‰ ë¶„ì‚° ê¸°ë°˜ ë¶€í•˜ ë¶ˆê· í˜• ê°ì§€
  </button>
  <button class="btn btn-outline-secondary" onclick="loadAnalysis('concentration')">
    ğŸ§  íŠ¹ì • ì½”ì–´ ìì› ì§‘ì¤‘ë„ ë¶„ì„
  </button>
</div>
  </div>
  <hr color="red" size="10">
  <div class="container mt-5">
    <h3 class="mb-3">ğŸ“Š ì…ë ¥ ë°ì´í„° ìœ íš¨ì„± ë¶„ì„ ê²°ê³¼</h3>
    <div id="validation-result-area"></div>
  </div>
  <hr color="red" size="10">
<br>
  <div id="chart_div" style="width: 100%; height: 400px;"></div>

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="/sequelize2.js"></script>
</body>
